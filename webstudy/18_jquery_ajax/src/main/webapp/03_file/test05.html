<!DOCTYPE html>
<!--
	1 - form 플러그인 사용하기
	2 - FormData 객체 이용 
 -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
	<form id="fileForm">
		<input type="text" id="msg" name="msg" /><br>
		<input type="file" id="attach" name="attach" multiple="multiple"/><br>
		<button type="button">업로드</button>
	</form>
	<div id="result"></div>
    <script>
    	$("button").click(() => {
    		/*
    		console.dir( $("#attach")[0].files );
    		console.dir( $("#attach")[0].files[0] );
    		console.dir( $("#attach")[0].files[0].name );
    		console.dir( $("#attach")[0].files[0].size );
    		*/
    		// ajax를 이용한 폼의 데이터 처리
    		let fd = new FormData();
    		fd.append("msg", $("#msg").val());
    		
    		let files = $("#attach")[0].files;
    		for (let i = 0; i < files.length; i++) {
	    		fd.append("attach" + i, files[i]);
    		}
    		// ajax를 이용한 파일 업로드 설정
    		// 필수 2가지 설정 필요함 contentType: false, processData: false
    		$.ajax({
//     			url: "/18_jquery_ajax/file/test01.do",
    			url: "/18_jquery_ajax/file/test02.do",
    			type: "POST",
    			data: fd,
    			contentType: false,
    			processData: false,
    			success: (result) => {
    				$("#result").html(result);
    			}
    			
    		});
    	});
    </script>
</body>
</html>